<VirtualHost *:80>
  ServerName {{ apache_fqdn }}
  # TODO: ServerAlias

{% if apache_https | default(false) %}
  Redirect "/" "https://{{ apache_fqdn }}/"
{% endif %}

  # Logging
  ErrorLog "{{ apache_log_path }}/{{ apache_hostname }}-error.log"
  CustomLog "{{ apache_log_path }}/{{ apache_hostname }}-access.log" combined
</VirtualHost>

{% if apache_https | default(false) %}
<VirtualHost *:443>
   ServerName {{ apache_hostname }}

   # Logging
   ErrorLog "{{ apache_log_path }}/{{ apache_hostname }}-ssl-error.log"
   CustomLog "{{ apache_log_path }}/{{ apache_hostname }}-ssl-access.log" combined

   SSLEngine on

   SSLProtocol all -SSLv2
   SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5:!SEED:!IDEA
   SSLCertificateFile {{ ssl_certificate_path }}/{{ ssl_certificate_file }}
   SSLCertificateKeyFile {{ ssl_certificate_key_path }}/{{ ssl_certificate_key_file }}
   {% if ssl_certificate_chain_file | default(false) %}
   SSLCertificateChainFile {{ ssl_certificate_path }}/{{ ssl_certificate_chain_file }}
   {% endif %}

</VirtualHost>
{% endif %}
